{"resourceType":"TestScript","id":"testscript-example-search","text":{"status":"generated","div":"<div xmlns=\"http://www.w3.org/1999/xhtml\"><p><b>Generated Narrative: TestScript</b><a name=\"testscript-example-search\"> </a></p><div style=\"display: inline-block; background-color: #d9e0e7; padding: 6px; margin: 4px; border: 1px solid #8da1b4; border-radius: 5px; line-height: 60%\"><p style=\"margin-bottom: 0px\">Resource TestScript &quot;testscript-example-search&quot; </p></div><p><b>url</b>: <code>http://hl7.org/fhir/TestScript/testscript-example-search</code></p><p><b>identifier</b>: id: urn:oid:2.16.840.1.113883.4.642.12.3</p><p><b>version</b>: 1.0</p><p><b>name</b>: TestScriptExampleSearch</p><p><b>title</b>: TestScript Example Search</p><p><b>status</b>: draft</p><p><b>experimental</b>: true</p><p><b>date</b>: 2017-01-18</p><p><b>publisher</b>: HL7</p><p><b>contact</b>: Support: <a href=\"mailto:support@HL7.org\">support@HL7.org</a></p><p><b>description</b>: TestScript example resource with simple Patient search test. The read tests will utilize user defined dynamic variables that will hold the Patient search parameter values.</p><p><b>jurisdiction</b>: United States of America (the) <span style=\"background: LightGoldenRodYellow; margin: 4px; border: 1px solid khaki\"> (<a href=\"http://terminology.hl7.org/5.1.0/CodeSystem-ISO3166Part1.html\">ISO 3166-1 Codes for the representation of names of countries and their subdivisions — Part 1: Country code</a>#US)</span></p><p><b>purpose</b>: Patient Search Operation</p><p><b>copyright</b>: © HL7.org 2011+</p><blockquote><p><b>metadata</b></p><h3>Links</h3><table class=\"grid\"><tr><td>-</td><td><b>Url</b></td><td><b>Description</b></td></tr><tr><td>*</td><td><a href=\"http://hl7.org/fhir/patient.html\">http://hl7.org/fhir/patient.html</a></td><td>Demographics and other administrative information about an individual or animal receiving care or other health-related services.</td></tr></table><h3>Capabilities</h3><table class=\"grid\"><tr><td>-</td><td><b>Required</b></td><td><b>Validated</b></td><td><b>Description</b></td><td><b>Link</b></td><td><b>Capabilities</b></td></tr><tr><td>*</td><td>true</td><td>false</td><td>Patient Search Operation</td><td><a href=\"http://hl7.org/fhir/http.html#search\">http://hl7.org/fhir/http.html#search</a></td><td><a href=\"http://hl7.org/fhir/CapabilityStatement/example\">http://hl7.org/fhir/CapabilityStatement/example</a></td></tr></table></blockquote><h3>Fixtures</h3><table class=\"grid\"><tr><td>-</td><td><b>Autocreate</b></td><td><b>Autodelete</b></td><td><b>Resource</b></td></tr><tr><td>*</td><td>false</td><td>false</td><td><a href=\"patient-example.html\">Patient/example: Peter Chalmers</a> &quot;Peter CHALMERS&quot;</td></tr></table><p><b>profile</b>: <a href=\"bundle.html\">Bundle</a></p><blockquote><p><b>variable</b></p><p><b>name</b>: PatientCreateLocation</p><p><b>headerField</b>: Location</p><p><b>sourceId</b>: PatientCreateResponse</p></blockquote><blockquote><p><b>variable</b></p><p><b>name</b>: PatientSearchFamilyName</p><p><b>description</b>: Enter patient search criteria for a known family name on the target system</p><p><b>hint</b>: [Family name]</p></blockquote><blockquote><p><b>variable</b></p><p><b>name</b>: PatientSearchGivenName</p><p><b>description</b>: Enter patient search criteria for a known given name on the target system</p><p><b>hint</b>: [Given name]</p></blockquote><blockquote><p><b>variable</b></p><p><b>name</b>: PatientSearchBundleTotal</p><p><b>description</b>: Evaluate the returned Patient searchset Bundle.total value</p><p><b>expression</b>: Bundle.total.toInteger()</p></blockquote><blockquote><p><b>setup</b></p><blockquote><p><b>action</b></p><h3>Operations</h3><table class=\"grid\"><tr><td>-</td><td><b>Type</b></td><td><b>Resource</b></td><td><b>Description</b></td><td><b>Accept</b></td><td><b>EncodeRequestUrl</b></td><td><b>Params</b></td></tr><tr><td>*</td><td>search (Details: http://hl7.org/fhir/restful-interaction code search = 'search', stated as 'null')</td><td><a href=\"patient.html\">Patient</a></td><td>Test simple search to verify server support.</td><td>xml</td><td>true</td><td>?family=DONTEXPECTAMATCH&amp;given=DONTEXPECTAMATCH</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Asserts</h3><table class=\"grid\"><tr><td>-</td><td><b>Description</b></td><td><b>Direction</b></td><td><b>Operator</b></td><td><b>RequestURL</b></td><td><b>StopTestOnFail</b></td><td><b>WarningOnly</b></td></tr><tr><td>*</td><td>Confirm that the request url contains the family search parameter.</td><td>request</td><td>contains</td><td>family</td><td>false</td><td>false</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Asserts</h3><table class=\"grid\"><tr><td>-</td><td><b>Description</b></td><td><b>Direction</b></td><td><b>ResponseCode</b></td><td><b>StopTestOnFail</b></td><td><b>WarningOnly</b></td></tr><tr><td>*</td><td>Confirm that the returned HTTP status is 200(OK).</td><td>response</td><td>200</td><td>false</td><td>false</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Asserts</h3><table class=\"grid\"><tr><td>-</td><td><b>Description</b></td><td><b>Resource</b></td><td><b>StopTestOnFail</b></td><td><b>WarningOnly</b></td></tr><tr><td>*</td><td>Confirm that the returned resource type is Bundle.</td><td><a href=\"bundle.html\">Bundle</a></td><td>false</td><td>false</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Asserts</h3><table class=\"grid\"><tr><td>-</td><td><b>Description</b></td><td><b>NavigationLinks</b></td><td><b>StopTestOnFail</b></td><td><b>WarningOnly</b></td></tr><tr><td>*</td><td>Confirm that the returned Bundle correctly defines the navigation links.</td><td>true</td><td>false</td><td>false</td></tr></table></blockquote></blockquote><blockquote><p><b>test</b></p><p><b>name</b>: Patient Create Search</p><p><b>description</b>: Create a Patient resource and capture the returned HTTP Header Location. Then search for (read) that Patient using the Location URL value and validate the response.</p><blockquote><p><b>action</b></p><h3>Operations</h3><table class=\"grid\"><tr><td>-</td><td><b>Type</b></td><td><b>Resource</b></td><td><b>Description</b></td><td><b>Accept</b></td><td><b>ContentType</b></td><td><b>EncodeRequestUrl</b></td><td><b>ResponseId</b></td><td><b>SourceId</b></td></tr><tr><td>*</td><td>create (Details: http://hl7.org/fhir/restful-interaction code create = 'create', stated as 'null')</td><td><a href=\"patient.html\">Patient</a></td><td>Create a Patient resource and capture the returned HTTP Header Location.</td><td>xml</td><td>xml</td><td>true</td><td>PatientCreateResponse</td><td>fixture-patient-create</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Asserts</h3><table class=\"grid\"><tr><td>-</td><td><b>Description</b></td><td><b>Response</b></td><td><b>StopTestOnFail</b></td><td><b>WarningOnly</b></td></tr><tr><td>*</td><td>Confirm that the returned HTTP status is 201(Created).</td><td>created</td><td>false</td><td>false</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Asserts</h3><table class=\"grid\"><tr><td>-</td><td><b>Description</b></td><td><b>Direction</b></td><td><b>HeaderField</b></td><td><b>Operator</b></td><td><b>StopTestOnFail</b></td><td><b>WarningOnly</b></td></tr><tr><td>*</td><td>Confirm that the returned HTTP Header Location is present.</td><td>response</td><td>Location</td><td>notEmpty</td><td>false</td><td>false</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Operations</h3><table class=\"grid\"><tr><td>-</td><td><b>Type</b></td><td><b>Description</b></td><td><b>Accept</b></td><td><b>EncodeRequestUrl</b></td><td><b>Url</b></td></tr><tr><td>*</td><td>read (Details: http://hl7.org/fhir/restful-interaction code read = 'read', stated as 'null')</td><td>Read the created Patient using the captured Location URL value.</td><td>xml</td><td>true</td><td>${PatientCreateLocation}</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Asserts</h3><table class=\"grid\"><tr><td>-</td><td><b>Description</b></td><td><b>Response</b></td><td><b>StopTestOnFail</b></td><td><b>WarningOnly</b></td></tr><tr><td>*</td><td>Confirm that the returned HTTP status is 200(OK).</td><td>okay</td><td>false</td><td>false</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Asserts</h3><table class=\"grid\"><tr><td>-</td><td><b>Description</b></td><td><b>Resource</b></td><td><b>StopTestOnFail</b></td><td><b>WarningOnly</b></td></tr><tr><td>*</td><td>Confirm that the returned resource type is Patient.</td><td><a href=\"patient.html\">Patient</a></td><td>false</td><td>false</td></tr></table></blockquote></blockquote><blockquote><p><b>test</b></p><p><b>name</b>: Patient Search Dynamic</p><p><b>description</b>: Search for Patient resources using the user defined dynamic variables ${PatientSearchFamilyName} and ${PatientSearchGivenName} and validate response.</p><blockquote><p><b>action</b></p><h3>Operations</h3><table class=\"grid\"><tr><td>-</td><td><b>Type</b></td><td><b>Resource</b></td><td><b>Description</b></td><td><b>Accept</b></td><td><b>EncodeRequestUrl</b></td><td><b>Params</b></td></tr><tr><td>*</td><td>search (Details: http://hl7.org/fhir/restful-interaction code search = 'search', stated as 'null')</td><td><a href=\"patient.html\">Patient</a></td><td>Search for Patient resources on the destination test system.</td><td>xml</td><td>true</td><td>?family=${PatientSearchFamilyName}&amp;given=${PatientSearchGivenName}</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Asserts</h3><table class=\"grid\"><tr><td>-</td><td><b>Description</b></td><td><b>Response</b></td><td><b>StopTestOnFail</b></td><td><b>WarningOnly</b></td></tr><tr><td>*</td><td>Confirm that the returned HTTP status is 200(OK).</td><td>okay</td><td>false</td><td>false</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Asserts</h3><table class=\"grid\"><tr><td>-</td><td><b>Description</b></td><td><b>ContentType</b></td><td><b>StopTestOnFail</b></td><td><b>WarningOnly</b></td></tr><tr><td>*</td><td>Confirm that the returned format is XML.</td><td>xml</td><td>false</td><td>false</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Asserts</h3><table class=\"grid\"><tr><td>-</td><td><b>Description</b></td><td><b>Resource</b></td><td><b>StopTestOnFail</b></td><td><b>WarningOnly</b></td></tr><tr><td>*</td><td>Confirm that the returned resource type is Bundle.</td><td><a href=\"bundle.html\">Bundle</a></td><td>true</td><td>false</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Asserts</h3><table class=\"grid\"><tr><td>-</td><td><b>Description</b></td><td><b>StopTestOnFail</b></td><td><b>ValidateProfileId</b></td><td><b>WarningOnly</b></td></tr><tr><td>*</td><td>Confirm that the returned Bundle conforms to the base FHIR specification.</td><td>false</td><td>bundle-profile</td><td>false</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Asserts</h3><table class=\"grid\"><tr><td>-</td><td><b>Description</b></td><td><b>Operator</b></td><td><b>Path</b></td><td><b>StopTestOnFail</b></td><td><b>Value</b></td><td><b>WarningOnly</b></td></tr><tr><td>*</td><td>Confirm that the returned Bundle type equals 'searchset'.</td><td>equals</td><td>fhir:Bundle/fhir:type/@value</td><td>false</td><td>searchset</td><td>false</td></tr></table></blockquote><blockquote><p><b>action</b></p><h3>Asserts</h3><table class=\"grid\"><tr><td>-</td><td><b>Description</b></td><td><b>Expression</b></td><td><b>StopTestOnFail</b></td><td><b>WarningOnly</b></td></tr><tr><td>*</td><td>Confirm that the returned Bundle total is greater than or equal to the number of returned entries.</td><td>Bundle.total.toInteger() &gt;= entry.count()</td><td>false</td><td>false</td></tr></table></blockquote></blockquote></div>"},"url":"http://hl7.org/fhir/TestScript/testscript-example-search","identifier":[{"system":"urn:ietf:rfc:3986","value":"urn:oid:2.16.840.1.113883.4.642.12.3"}],"version":"1.0","name":"TestScriptExampleSearch","title":"TestScript Example Search","status":"draft","experimental":true,"date":"2017-01-18","publisher":"HL7","contact":[{"name":"Support","telecom":[{"system":"email","value":"support@HL7.org","use":"work"}]}],"description":"TestScript example resource with simple Patient search test. The read tests will utilize user defined dynamic variables that will hold the Patient search parameter values.","jurisdiction":[{"coding":[{"system":"urn:iso:std:iso:3166","code":"US","display":"United States of America (the)"}]}],"purpose":"Patient Search Operation","copyright":"© HL7.org 2011+","metadata":{"link":[{"url":"http://hl7.org/fhir/patient.html","description":"Demographics and other administrative information about an individual or animal receiving care or other health-related services."}],"capability":[{"required":true,"validated":false,"description":"Patient Search Operation","link":["http://hl7.org/fhir/http.html#search"],"capabilities":"http://hl7.org/fhir/CapabilityStatement/example"}]},"fixture":[{"id":"fixture-patient-create","autocreate":false,"autodelete":false,"resource":{"reference":"Patient/example","display":"Peter Chalmers"}}],"profile":["http://hl7.org/fhir/StructureDefinition/Bundle"],"variable":[{"name":"PatientCreateLocation","headerField":"Location","sourceId":"PatientCreateResponse"},{"name":"PatientSearchFamilyName","description":"Enter patient search criteria for a known family name on the target system","hint":"[Family name]"},{"name":"PatientSearchGivenName","description":"Enter patient search criteria for a known given name on the target system","hint":"[Given name]"},{"name":"PatientSearchBundleTotal","description":"Evaluate the returned Patient searchset Bundle.total value","expression":"Bundle.total.toInteger()"}],"setup":{"action":[{"operation":{"type":{"system":"http://hl7.org/fhir/restful-interaction","code":"search"},"resource":"Patient","description":"Test simple search to verify server support.","accept":"xml","encodeRequestUrl":true,"params":"?family=DONTEXPECTAMATCH&given=DONTEXPECTAMATCH"}},{"assert":{"description":"Confirm that the request url contains the family search parameter.","direction":"request","operator":"contains","requestURL":"family","stopTestOnFail":false,"warningOnly":false}},{"assert":{"description":"Confirm that the returned HTTP status is 200(OK).","direction":"response","responseCode":"200","stopTestOnFail":false,"warningOnly":false}},{"assert":{"description":"Confirm that the returned resource type is Bundle.","resource":"Bundle","stopTestOnFail":false,"warningOnly":false}},{"assert":{"description":"Confirm that the returned Bundle correctly defines the navigation links.","navigationLinks":true,"stopTestOnFail":false,"warningOnly":false}}]},"test":[{"id":"01-PatientCreateSearch","name":"Patient Create Search","description":"Create a Patient resource and capture the returned HTTP Header Location. Then search for (read) that Patient using the Location URL value and validate the response.","action":[{"operation":{"type":{"system":"http://hl7.org/fhir/restful-interaction","code":"create"},"resource":"Patient","description":"Create a Patient resource and capture the returned HTTP Header Location.","accept":"xml","contentType":"xml","encodeRequestUrl":true,"responseId":"PatientCreateResponse","sourceId":"fixture-patient-create"}},{"assert":{"description":"Confirm that the returned HTTP status is 201(Created).","response":"created","stopTestOnFail":false,"warningOnly":false}},{"assert":{"description":"Confirm that the returned HTTP Header Location is present.","direction":"response","headerField":"Location","operator":"notEmpty","stopTestOnFail":false,"warningOnly":false}},{"operation":{"type":{"system":"http://hl7.org/fhir/restful-interaction","code":"read"},"description":"Read the created Patient using the captured Location URL value.","accept":"xml","encodeRequestUrl":true,"url":"${PatientCreateLocation}"}},{"assert":{"description":"Confirm that the returned HTTP status is 200(OK).","response":"okay","stopTestOnFail":false,"warningOnly":false}},{"assert":{"description":"Confirm that the returned resource type is Patient.","resource":"Patient","stopTestOnFail":false,"warningOnly":false}}]},{"id":"02-PatientSearchDynamic","name":"Patient Search Dynamic","description":"Search for Patient resources using the user defined dynamic variables ${PatientSearchFamilyName} and ${PatientSearchGivenName} and validate response.","action":[{"operation":{"type":{"system":"http://hl7.org/fhir/restful-interaction","code":"search"},"resource":"Patient","description":"Search for Patient resources on the destination test system.","accept":"xml","encodeRequestUrl":true,"params":"?family=${PatientSearchFamilyName}&given=${PatientSearchGivenName}"}},{"assert":{"description":"Confirm that the returned HTTP status is 200(OK).","response":"okay","stopTestOnFail":false,"warningOnly":false}},{"assert":{"description":"Confirm that the returned format is XML.","contentType":"xml","stopTestOnFail":false,"warningOnly":false}},{"assert":{"description":"Confirm that the returned resource type is Bundle.","resource":"Bundle","stopTestOnFail":true,"warningOnly":false}},{"assert":{"description":"Confirm that the returned Bundle conforms to the base FHIR specification.","stopTestOnFail":false,"validateProfileId":"bundle-profile","warningOnly":false}},{"assert":{"description":"Confirm that the returned Bundle type equals 'searchset'.","operator":"equals","path":"fhir:Bundle/fhir:type/@value","stopTestOnFail":false,"value":"searchset","warningOnly":false}},{"assert":{"description":"Confirm that the returned Bundle total is greater than or equal to the number of returned entries.","expression":"Bundle.total.toInteger() >= entry.count()","stopTestOnFail":false,"warningOnly":false}}]}]}